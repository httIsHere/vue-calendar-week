!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("vue-calendar-week",[],e):"object"==typeof exports?exports["vue-calendar-week"]=e():t["vue-calendar-week"]=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,a){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=1)}([function(t,e,r){"use strict";var a=r(9),n=r(10);e.a={name:"CalendarByWeek",props:{granularity:{type:[String,Number],default:30},startDate:{type:String,required:!0},startTime:{type:[String,Number],default:0,validator:function(t){return t%1==0}},endTime:{type:[String,Number],default:24,validator:function(t){return t%1==0}},unitTime:{type:[String,Number],default:1},data:{type:Array,default:[]},readonly:{type:Boolean,default:!1},disabledTime:{type:Function,default:function(t){return(new Date).getTime()>=new Date(t).getTime()}},needBottomTime:{type:Boolean,default:!1},toastMessage:{type:Object,default:function(){return{disabledTime:"该时间段不可安排日程",timeConflict:"存在时间冲突，请重新安排"}}},hasHeader:{type:Boolean,default:!0}},components:{CalendarSlot:n.a},provide:function(){return{calendarRoot:this}},data:function(){return{is_mousedown:!1,is_mouseup:!1,select_cells:{col:-1,start_row:-1,over_rows:0,end_row:-1},is_rowspan:!1,data_list:null,week_day:["周日","周一","周二","周三","周四","周五","周六"],click_start:null,click_end:null}},filters:{formatHourWithInt:function(t){return t>=10?t+":00":"0"+t+":00"}},computed:{columns:function(){return a.a.getDatesArray(this.startDate,7)},unitNum:function(){try{if(60%this.granularity!=0)throw"Bad 'granularuty', check whether the parameters 'granularity' meet the parameter requirements.";return Math.floor(60*this.unitTime/this.granularity)}catch(t){console.error(t)}},rows:function(){var t=parseInt(this.startTime),e=parseInt(this.endTime);try{if((e-t)%this.unitTime!=0)throw"Bad 'unit time";for(var r=(e-t)/this.unitTime*this.unitNum,n=new Array(r),s=0;s<(e-t)/this.unitTime;s++){var i=s*parseInt(this.unitTime)+t;n[s*this.unitNum]=""+a.a.formatHourWithInt(i)}return n}catch(t){console.error(t)}},select_period:function(){var t=this.select_cells,e=t.start_row,r=t.over_rows;if(e<0)return"";var n=parseInt(this.startTime),s=n+Math.floor(e/this.unitNum),i=60*s+e%this.unitNum*this.granularity,o=i+(r+1)*this.granularity;return a.a.formatTimeWithMinutes(i)+"-"+a.a.formatTimeWithMinutes(o)}},mounted:function(){this.initTableArray(),this.initRecordList(this.data)},methods:{resetSelection:function(){this.select_cells={col:-1,start_row:-1,over_rows:0,end_row:-1},this.is_mousedown=!1},onTableMouseDown:function(t,e,r){if(!this.readonly)return this.data_list[r][e]&&(this.data_list[r][e].has_record||this.data_list[r][e].is_passed)?this.$emit("on-error",this.toastMessage.disabledTime):void(r===this.select_cells.col&&e>=this.select_cells.start_row&&e<=this.select_cells.end_row||0===t.button&&(this.is_rowspan=!1,this.is_mousedown||(this.click_start=(new Date).getTime(),this.is_mousedown=!0,this.select_cells={col:r,start_row:e,over_rows:0})))},onTableMouseOver:function(t,e,r){if(this.is_mousedown){if(this.data_list[r][e]&&this.data_list[r][e].has_record)return this.$emit("on-error",this.toastMessage.timeConflict),this.resetSelection();if(this.data_list[r][e]&&this.data_list[r][e].is_passed)return this.$emit("on-error",this.toastMessage.disabledTime),this.resetSelection();if(this.is_mousedown&&this.select_cells.col===r){var a=e-this.select_cells.start_row;this.select_cells.over_rows=a}}},onTableMouseUp:function(t,e,r){if(this.is_mousedown){var a=e-this.select_cells.start_row;if(0===a&&(this.click_end=(new Date).getTime(),this.click_end-this.click_start<300)){var n=Math.floor(e/this.unitNum)*this.unitNum;a=this.unitNum-1,this.select_cells.start_row=n}a<0&&(this.select_cells.start_row=e,a=-a);for(var s=!1,i=this.select_cells.start_row,o=i;o<=i+a;o++){if(this.data_list[r][o]&&this.data_list[r][o].has_record){s=!0,this.$emit("on-error",this.toastMessage.timeConflict),this.resetSelection();break}if(this.data_list[r][o]&&this.data_list[r][o].is_passed){s=!0,this.$emit("on-error",this.toastMessage.disabledTime),this.resetSelection();break}}if(s)return;this.select_cells.end_row=this.select_cells.start_row+a,this.select_cells.over_rows=a,this.is_mousedown=!1,this.is_rowspan=!0,this.onSelected()}},onContextMenu:function(t,e,r){this.data_list[r][e]&&this.data_list[r][e].has_record&&this.$emit("on-contextmenu",e,this.data_list[r][e],t)},initTableArray:function(){var t=this,e=new Array;for(var r in t.columns){e[r]=new Array;for(var n=0;n<t.rows.length;n++){var s=t.columns[r].date,i=a.a.formatTimeWithMinutes(60*parseInt(t.startTime)+n*t.granularity),o=t.disabledTime(s+" "+i);e[r][n]={is_passed:o}}}t.data_list=e},initRecordList:function(t){var e=this;e.cancelSelect();var r=[];this.initTableArray();var a=JSON.parse(JSON.stringify(e.data_list));t&&t.forEach(function(t){var n=t.date.replace(new RegExp("-","gm"),"/"),s=e.columns.findIndex(function(t){return new Date(t.date).getTime()===new Date(n).getTime()});if(!(s<0)){var i=60*parseInt(t.start_time.split(":")[0])+parseInt(t.start_time.split(":")[1]),o=60*parseInt(t.end_time.split(":")[0])+parseInt(t.end_time.split(":")[1]),l=(i-60*parseInt(e.startTime))/e.granularity,c=(o-i)/e.granularity,d={has_record:!0,is_before_created:!0,date_col:s,start_row:l,over_rows:c,content:t.content,time:t.start_time+"-"+t.end_time};r.push(d),a[s][l]=Object.assign(a[s][l],d,t);for(var u=l+1;u<l+c;u++)a[s][u].has_record=!0}}),e.data_list=a},cancelSelect:function(){this.resetSelection()},onSelected:function(){if(!this.readonly){var t=this.columns[this.select_cells.col].date,e=this.select_period.split("-")[0],r=this.select_period.split("-")[1];this.$emit("on-selected",{date:t,start_time:e,end_time:r,start_row:this.select_cells.start_row,over_rows:this.select_cells.over_rows})}}},watch:{data:{handler:function(t,e){this.initRecordList(t)},deep:!0}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r(2),n={install:function(t){t.component("CalendarByWeek",a.a)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(n),e.default=n},function(t,e,r){"use strict";function a(t){r(3)}var n=r(0),s=r(11),i=r(8),o=a,l=i(n.a,s.a,!1,o,"data-v-56848bbf",null);e.a=l.exports},function(t,e,r){var a=r(4);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r(6)("35aa152c",a,!0,{})},function(t,e,r){e=t.exports=r(5)(!1),e.push([t.i,"td[data-v-56848bbf]{width:100px;height:20px;text-align:center;cursor:pointer;line-height:1}.disNone[data-v-56848bbf]{display:none}.calendar-table[data-v-56848bbf]{border-right:1px solid #eee}.calendar-table__th-d[data-v-56848bbf]{border-top:1px solid #eee;height:50px;background:rgba(102,153,204,.8);color:#fff}.calendar-table__td[data-v-56848bbf]{border-left:1px solid #eee;font-size:12px}.calendar-table__td.disabled[data-v-56848bbf]{background:#fafafa}.calendar-table__td-top[data-v-56848bbf]{border-top:1px solid #eee}.calendar-table__td-bottom[data-v-56848bbf]{border-bottom:1px solid #eee}.calendar-table__td-span[data-v-56848bbf]{border-top:none;border-left:none;vertical-align:top;position:relative}.calendar-table__td-span .time[data-v-56848bbf]{display:block;margin-top:-8px}.calendar-table__td-span .time-bottom[data-v-56848bbf]{position:absolute;bottom:-8px;width:100%;text-align:center}.calendar-table__td-null[data-v-56848bbf]{border-left:none;border-top:none;background:unset}.calendar-table__td.selected-cell-span[data-v-56848bbf]{background:rgba(153,204,255,.3);padding-top:5px;box-sizing:border-box}.calendar-table__td-record[data-v-56848bbf]{background:rgba(153,204,255,.1)}.calendar-table .slot-item[data-v-56848bbf]{padding-top:5px}.calendar-table .item-default[data-v-56848bbf],.calendar-table .slot-item[data-v-56848bbf]{width:100%;height:100%;box-sizing:border-box}",""])},function(t,e){function r(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var s=a(n);return[r].concat(n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"})).concat([s]).join("\n")}return[r].join("\n")}function a(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var a=r(e,t);return e[2]?"@media "+e[2]+"{"+a+"}":a}).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var a={},n=0;n<this.length;n++){var s=this[n][0];"number"==typeof s&&(a[s]=!0)}for(n=0;n<t.length;n++){var i=t[n];"number"==typeof i[0]&&a[i[0]]||(r&&!i[2]?i[2]=r:r&&(i[2]="("+i[2]+") and ("+r+")"),e.push(i))}},e}},function(t,e,r){function a(t){for(var e=0;e<t.length;e++){var r=t[e],a=d[r.id];if(a){a.refs++;for(var n=0;n<a.parts.length;n++)a.parts[n](r.parts[n]);for(;n<r.parts.length;n++)a.parts.push(s(r.parts[n]));a.parts.length>r.parts.length&&(a.parts.length=r.parts.length)}else{for(var i=[],n=0;n<r.parts.length;n++)i.push(s(r.parts[n]));d[r.id]={id:r.id,refs:1,parts:i}}}}function n(){var t=document.createElement("style");return t.type="text/css",u.appendChild(t),t}function s(t){var e,r,a=document.querySelector("style["+b+'~="'+t.id+'"]');if(a){if(p)return h;a.parentNode.removeChild(a)}if(v){var s=f++;a=_||(_=n()),e=i.bind(null,a,s,!1),r=i.bind(null,a,s,!0)}else a=n(),e=o.bind(null,a),r=function(){a.parentNode.removeChild(a)};return e(t),function(a){if(a){if(a.css===t.css&&a.media===t.media&&a.sourceMap===t.sourceMap)return;e(t=a)}else r()}}function i(t,e,r,a){var n=r?"":a.css;if(t.styleSheet)t.styleSheet.cssText=w(e,n);else{var s=document.createTextNode(n),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(s,i[e]):t.appendChild(s)}}function o(t,e){var r=e.css,a=e.media,n=e.sourceMap;if(a&&t.setAttribute("media",a),m.ssrId&&t.setAttribute(b,e.id),n&&(r+="\n/*# sourceURL="+n.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var l="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!l)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var c=r(7),d={},u=l&&(document.head||document.getElementsByTagName("head")[0]),_=null,f=0,p=!1,h=function(){},m=null,b="data-vue-ssr-id",v="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());t.exports=function(t,e,r,n){p=r,m=n||{};var s=c(t,e);return a(s),function(e){for(var r=[],n=0;n<s.length;n++){var i=s[n],o=d[i.id];o.refs--,r.push(o)}e?(s=c(t,e),a(s)):s=[];for(var n=0;n<r.length;n++){var o=r[n];if(0===o.refs){for(var l=0;l<o.parts.length;l++)o.parts[l]();delete d[o.id]}}}};var w=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t,e){for(var r=[],a={},n=0;n<e.length;n++){var s=e[n],i=s[0],o=s[1],l=s[2],c=s[3],d={id:t+":"+n,css:o,media:l,sourceMap:c};a[i]?a[i].parts.push(d):r.push(a[i]={id:i,parts:[d]})}return r}},function(t,e){t.exports=function(t,e,r,a,n,s){var i,o=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(i=t,o=t.default);var c="function"==typeof o?o.options:o;e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),r&&(c.functional=!0),n&&(c._scopeId=n);var d;if(s?(d=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=d):a&&(d=a),d){var u=c.functional,_=u?c.render:c.beforeCreate;u?(c._injectStyles=d,c.render=function(t,e){return d.call(e),_(t,e)}):c.beforeCreate=_?[].concat(_,d):[d]}return{esModule:i,exports:o,options:c}}},function(t,e,r){"use strict";var a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!t)return null;if(t=t.replace(new RegExp("-","gm"),"/"),!e)return[t];for(var r=new Array(e),a=new Date(t),s=0;s<e;s++){var i=a.getTime()+864e5*s,o=new Date(i).getDay();i=n(i),r[s]={date:i,day:o}}return r},n=function(t){return t=t instanceof Date?t:new Date(t),t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()},s=function(t){return t>=10?t+":00":"0"+t+":00"},i=function(t){var e=Math.floor(t/60),r=Math.floor(t%60);return e=e>=10?e:"0"+e,r=r>=10?r:"0"+r,e+":"+r};e.a={getDatesArray:a,formatDateOnlyDate:n,formatHourWithInt:s,formatTimeWithMinutes:i}},function(t,e,r){"use strict";e.a={name:"CalendarSlot",functional:!0,inject:["calendarRoot"],props:{item:Object},render:function(t,e){return t("div",{class:"slot-item"},e.injections.calendarRoot.$scopedSlots.default({item:e.props.item}))}}},function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"component-box component-calendar",attrs:{onselectstart:"return false"}},[r("table",{staticClass:"calendar-table",attrs:{cellspacing:"0",cellpadding:"0"}},[t.hasHeader?r("tr",{staticClass:"calendar-table__tr calendar-table__th"},[r("td",{staticClass:"calendar-table__td calendar-table__th-d calendar-table__td-null"}),t._v(" "),t._l(t.columns,function(e){return r("td",{key:e.week,staticClass:"calendar-table__td calendar-table__th-d"},[t._t("thead",[t._v("\n          "+t._s(t.week_day[e.day])),r("br"),t._v(t._s(e.date)+"\n        ")],{item:e})],2)})],2):t._e(),t._v(" "),t._l(t.rows,function(e,a){return r("tr",{key:a,staticClass:"calendar-table__tr"},[a%t.unitNum==0?[r("td",{staticClass:"calendar-table__td calendar-table__td-span",attrs:{rowspan:t.unitNum}},[r("span",{staticClass:"time"},[t._v(t._s(t.rows[a]))]),t._v(" "),t.needBottomTime&&a===t.rows.length-t.unitNum?r("span",{staticClass:"time time-bottom"},[t._v(t._s(t._f("formatHourWithInt")(t.endTime)))]):t._e()])]:t._e(),t._v(" "),t._l(t.columns,function(e,n){return r("td",{key:n,class:["calendar-table__td",a%t.unitNum==0?"calendar-table__td-top":"",a===t.rows.length-1?"calendar-table__td-bottom":"",t.data_list&&t.data_list[n][a]&&t.data_list[n][a].is_passed?"disabled":"",t.data_list&&t.data_list[n][a]&&t.data_list[n][a].has_record&&t.data_list[n][a].start_row===a?"calendar-table__td-record calendar-table__td-record-"+t.data_list[n][a].over_rows:"",t.is_rowspan&&t.select_cells.col===n&&t.select_cells.start_row<a&&t.select_cells.start_row+t.select_cells.over_rows>=a?"disNone":t.data_list&&t.data_list[n][a]&&t.data_list[n][a].has_record&&t.data_list[n][a].start_row!==a?"disNone":"",t.select_cells.col===n&&(t.select_cells.over_rows>=0?t.select_cells.start_row<=a&&t.select_cells.start_row+t.select_cells.over_rows>=a:t.select_cells.start_row>=a&&t.select_cells.start_row+t.select_cells.over_rows<=a)?"selected-cell-span":""],attrs:{rowspan:t.is_rowspan&&t.select_cells.col===n&&t.select_cells.start_row===a?t.select_cells.over_rows+1:!!(t.data_list&&t.data_list[n][a]&&t.data_list[n][a].has_record&&t.data_list[n][a].start_row===a)&&t.data_list[n][a].over_rows},on:{mousedown:function(e){return t.onTableMouseDown(e,a,n)},mouseover:function(e){return t.onTableMouseOver(e,a,n)},mouseup:function(e){return t.onTableMouseUp(e,a,n)},contextmenu:function(e){return e.preventDefault(),t.onContextMenu(e,a,n)}}},[t.select_cells.col===n&&t.select_cells.start_row===a?r("div",{staticClass:"item-default"},[t._v("\n          "+t._s(t.select_period)+"\n        ")]):t._e(),t._v(" "),t.data_list&&t.data_list[n][a]&&t.data_list[n][a].has_record&&t.data_list[n][a].start_row===a?[r("calendar-slot",{attrs:{item:t.data_list[n][a]}},[t._v("\n            "+t._s(t.data_list[n][a].time)),r("br"),t._v(t._s(t.data_list[n][a].content)+"\n          ")])]:t._e()],2)})],2)})],2)])},n=[],s={render:a,staticRenderFns:n};e.a=s}])});
//# sourceMappingURL=week-calendar.min.js.map